<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Nursery LKG UKG Result Portal</title>

<style>
body{
  font-family: Arial, sans-serif;
  background:#f2f2f2;
}
.container{
  max-width:900px;
  margin:20px auto;
  background:#fff;
  border:3px solid red;
  padding:15px;
}

/* HEADER */
.header{
  display:flex;
  align-items:center;
  gap:15px;
  border-bottom:2px solid #ccc;
  padding-bottom:10px;
}
.logo img{width:90px;}
.school-text{flex:1;text-align:center;}
.school-text h1{color:red;margin:4px 0;}
.school-text .info{font-weight:bold;margin:3px 0;}
.school-text h3{margin:3px 0;font-weight:normal;}

/* FORM */
.form{
  display:flex;
  gap:10px;
  flex-wrap:wrap;
  justify-content:center;
  margin-top:15px;
}
.form input,.form select{
  padding:8px;
  font-size:15px;
}
.hint{
  width:100%;
  text-align:center;
  font-size:12px;
  color:#555;
}
.form button{
  padding:8px 18px;
  font-size:15px;
  border:none;
  color:#fff;
  cursor:pointer;
}
.search{background:#0d6efd;}
.print{background:#198754;}

#error{color:red;margin-top:10px;text-align:center;}

/* TABLE */
table{width:100%;border-collapse:collapse;margin-top:15px;}
table,th,td{border:1px solid #000;}
th{background:#3fa2dd;color:#fff;padding:8px;}
td{padding:6px;text-align:center;}
.total-row td{background:#3fa2dd;color:#fff;font-weight:bold;}

/* FOOTER */
.footer{
  display:flex;
  justify-content:space-between;
  margin-top:40px;
}
.footer div{
  width:40%;
  text-align:center;
  border-top:1px solid #000;
  padding-top:5px;
}

/* PRINT */
@media print{
  .form,#error{display:none;}
  .container{border:none;}
}

/* MOBILE */
@media(max-width:600px){
  .header{flex-direction:column;}
  .logo img{margin:auto;}
}
</style>
</head>

<body>

<div class="container">

  <!-- HEADER -->
  <div class="header">
    <div class="logo">
      <img src="https://ik.imagekit.io/a2wpi1kd9/imgToUrl/image-to-url_9FkUjGvCmc" alt="School Logo">
    </div>
    <div class="school-text">
      <h1>BRIGHT CAREER PUBLIC SCHOOL</h1>
      <div class="info">
        LKG • UKG • Nursery/PG – HALF YEARLY RESULT
      </div>
      <h3>2025 SESSION</h3>
    </div>
  </div>

  <!-- SEARCH FORM -->
  <div class="form">
    <input id="roll" placeholder="Enter Roll No (e.g. BCPS1)">

    <select id="cls">
      <option value="">Select Class</option>
      <option>LKG</option><option>UKG</option><option>Nursery/PG</option>
    </select>

    <input type="date" id="dob">

    <button class="search" onclick="getResult()">Search</button>
    <button class="print" onclick="window.print()">Print</button>

    <div class="hint">
      Date of Birth example: <b>DD-MM-YYYY</b> (e.g. 08-11-2020)
    </div>
  </div>

  <div id="error"></div>
  <div id="result"></div>

</div>

<script>
const SHEET_URL =
"https://opensheet.elk.sh/1LKkksxm9qDMgxc4Q5-IyoLe2j12dyn3EDqQ40uXS7ro/Results";

function formatDateForSheet(d){
  const y = d.getFullYear();
  const m = String(d.getMonth()+1).padStart(2,'0');
  const dd= String(d.getDate()).padStart(2,'0');
  return `${y}-${m}-${dd}`;
}

async function getResult(){
  const roll = document.getElementById("roll").value.trim();
  const cls  = document.getElementById("cls").value;
  const dobInput = document.getElementById("dob").value;

  const error = document.getElementById("error");
  const result= document.getElementById("result");
  error.innerHTML="";
  result.innerHTML="";

  if(!roll || !cls || !dobInput){
    error.innerHTML="Please enter Roll, Class & DOB";
    return;
  }

  const dob = formatDateForSheet(new Date(dobInput));

  const res = await fetch(SHEET_URL);
  const data= await res.json();

  const r = data.find(x =>
    x["Roll"] === roll &&
    x["Class"] === cls &&
    x["Dob"] === dob
  );

  if(!r){
    error.innerHTML="Result not found";
    return;
  }

  result.innerHTML = `
    <p><b>Name:</b> ${r.Name} &nbsp;&nbsp;
       <b>Father:</b> ${r.Father}</p>
    <p><b>Roll:</b> ${r.Roll} &nbsp;&nbsp;
       <b>Class:</b> ${r.Class} &nbsp;&nbsp;
       <b>DOB:</b> ${r.Dob}</p>

    <table>
      <tr><th>Sr</th><th>Subject</th><th>Marks</th></tr>
      <tr><td>1</td><td>Hindi</td><td>${r.Hindi}</td></tr>
      <tr><td>2</td><td>English</td><td>${r.English}</td></tr>
      <tr><td>3</td><td>Maths</td><td>${r.Maths}</td></tr>
      <tr><td>4</td><td>Science</td><td>${r.Science}</td></tr>
      <tr><td>5</td><td>Gk</td><td>${r.Gk}</td></tr>
      <tr><td>6</td><td>Art</td><td>${r.Art}</td></tr>
      <tr><td>7</td><td>Hindirhymes</td><td>${r.Hindirhymes}</td></tr>
      <tr><td>8</td><td>Englishrhymes</td><td>${r.Englishrhymes}</td></tr>
      <tr><td>9</td><td>PT</td><td>${r.PT}</td></tr>

      <tr class="total-row"><td colspan="2">Total</td><td>${r.Total}</td></tr>
      <tr class="total-row"><td colspan="2">Percentage</td><td>${r.Percentage}</td></tr>
      <tr class="total-row"><td colspan="2">Result</td><td>${r.Result}</td></tr>
    </table>

    <div class="footer">
      <div>Class Teacher</div>
      <div>Principal</div>
    </div>
  `;
}
</script>

</body>
</html>
